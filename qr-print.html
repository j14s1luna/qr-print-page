<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>QR Sticker - Zebra 50x30mm</title>
<style>
  /* Zebra 50mm x 30mm label size */
  @page {
    size: 10cm 5cm;
    margin: 0;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    background: #fff;
  }

  .qr-item {
    width: 10cm;
    height: 5cm;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    text-align: center;
    box-sizing: border-box;
    padding: 0mm;
    page-break-after: always;   
   
  }

  .top-label {
    font-size: 8pt !important;
    font-weight: bold;
    margin-bottom: 1.5mm;
    
  }

  .qr-item img {
    width: 3cm;
    height: 3cm;
    object-fit: contain;
    margin: 0 auto;
    display: block;
  }

  .pharmacy-name {
    font-size: 12pt !important;
    font-weight: bold;
    margin-top: 1.5mm;
  }

  .packer-name {
    font-size: 4pt;
    margin-top:0.5mm;
    font-weight: 600;
  }

  .label {
    font-size: 6pt;
    line-height: 1;
    word-break: break-word;
    text-align: center;
  }

  @media print {
    body {
      margin: 0;
    }
    .qr-item {
      page-break-after: always;
      break-after: page;
    }
  }
</style>
</head>

<body>
  <div id="qrContainer">Loading QR Codes...</div>

  <script>
    function getParameterByName(name) {
      const params = new URLSearchParams(window.location.search);
      return params.get(name);
    }

    const dataParam = getParameterByName('data');
    const qrContainer = document.getElementById('qrContainer');

    if (!dataParam) {
      qrContainer.innerHTML = '<p style="color:red;">No data found in URL.</p>';
    } else {
      try {
        const decoded = decodeURIComponent(dataParam);
        const qrData = JSON.parse(decoded);
        qrContainer.innerHTML = '';

        qrData.forEach(item => {
          const qrCodeURL = "https://api.qrserver.com/v1/create-qr-code/?data=" +
            encodeURIComponent(item.BarcodeID) + "&size=250x250";

          const div = document.createElement('div');
          div.className = 'qr-item';

          const topLabel = document.createElement('div');
          topLabel.className = 'top-label';
          topLabel.innerText = 'Medicina Drug Store';

          const img = document.createElement('img');
          img.src = qrCodeURL;
          img.alt = 'QR code for ' + item.BarcodeID;

          const pharmacyName = document.createElement('div');
          pharmacyName.className = 'pharmacy-name';
          pharmacyName.innerText = item.PharmacyName || '';

          const packerName = document.createElement('div');
          packerName.className = 'packer-name';
          packerName.innerText = item.PackerName ? 'Packer: ' + item.PackerName : '';

          const label = document.createElement('div');
          label.className = 'label';
          label.innerHTML =
            (item.SuffixLabel ? "<div>" + item.SuffixLabel + "</div>" : "") +
            (item.MedicineName ? "<div>" + item.MedicineName + "</div>" : "");

          div.appendChild(topLabel);
          div.appendChild(img);
          div.appendChild(pharmacyName);
          div.appendChild(packerName);
          div.appendChild(label);

          qrContainer.appendChild(div);
        });
      } catch (e) {
        qrContainer.innerHTML = '<p style="color:red;">Error parsing QR data.</p>';
      }
    }
  </script>
</body>
</html>
